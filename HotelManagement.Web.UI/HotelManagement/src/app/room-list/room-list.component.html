<div class="room-list">
    <div class="container">
        <table>
            <tbody>
                <tr></tr>
                <tr *ngFor="let floor of floors" style="height: 100px;">
                    <td class="floor">Floor {{floor.name}}</td>
                    <td *ngFor="let room of floor.rooms" >

                        <dx-button id="{{room.name}}" (click)="chooseRoom($event.currentTarget.id)"
                                (dblclick)="inputBookingInfo($event.currentTarget.id)" class="room"
                                [style.background-color]="room.status === 'Available' ? 'green' : room.status === 'Booking' ? 'orange' : 'red' "
                                >
                            {{room.name}}
                            <p class="status">{{room.status}}</p>
                        </dx-button>

                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<dx-popup
    class="popup"
    width="60%"
    height="auto"
    [showTitle]="true"
    [title]="Information"
    [dragEnabled]="false"
    [closeOnOutsideClick]="false"
    [(visible)]="isVisibleBooking">
    <div class="panel">
        <div class="title">
            Booking information
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div class="dx-field">
                    <div class="dx-field-label">Price</div>
                    <div class="dx-field-value">
                        <dx-text-box [value]="roomBooking.price.toString() | currency: 'VND'"></dx-text-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Checkin</div>
                    <div class="dx-field-value">
                        <dx-date-box
                            [value]="dateNow"
                            type="datetime"
                            [(ngModel)]="roomBooking.checkinTime"
                            invalidDateMessage="The date must have the following format: MM/dd/yyyy">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Checkin time is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-date-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Checkout Estimate</div>
                    <div class="dx-field-value">
                        <dx-date-box
                            [value]="dateNow"
                            type="datetime"
                            [(ngModel)]="roomBooking.checkoutTime">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Checkout time is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-date-box>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="dx-field">
                    <div class="dx-field-label">Prepay</div>
                    <div class="dx-field-value">
                        <dx-text-box [(ngModel)]="personalBookingDetail.prePay">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Prepay time is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-text-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Discount</div>
                    <div class="dx-field-value">
                        <dx-text-box [(ngModel)]="personalBookingDetail.discount">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Discount is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-text-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Notes</div>
                    <div class="dx-field-value">
                        <dx-text-area
                            height="90"
                            [(ngModel)]="personalBookingDetail.notes">
                        </dx-text-area>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="panel">
        <div class="title">Client Information</div>
        <div class="row">
            <div class="col-sm-6">
                <div class="dx-field">
                    <div class="dx-field-label">Name</div>
                    <div class="dx-field-value">
                        <dx-text-box [(ngModel)]="client.name">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Name is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-text-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Address</div>
                    <div class="dx-field-value">
                        <dx-text-box [(ngModel)]="client.address">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Address is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-text-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Email</div>
                    <div class="dx-field-value">
                        <dx-text-box [(ngModel)]="client.email">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Email is required"></dxi-validation-rule>
                                <dxi-validation-rule type="email" message="Email is invalid"></dxi-validation-rule>
                            </dx-validator>
                        </dx-text-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Nationality</div>
                    <div class="dx-field-value">
                        <dx-text-box [(ngModel)]="client.nationality">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Nationality is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-text-box>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="dx-field">
                    <div class="dx-field-label">Identity/Passport</div>
                    <div class="dx-field-value">
                        <dx-text-box [(ngModel)]="client.identityOrPassport">
                            <dx-validator>
                                <dxi-validation-rule type="required" message="Identity/Passport number is required"></dxi-validation-rule>
                            </dx-validator>
                        </dx-text-box>
                    </div>
                </div>
                <div class="dx-field">
                    <div class="dx-field-label">Notes</div>
                    <div class="dx-field-value">
                        <dx-text-area
                            height="90"
                            [(ngModel)]="client.notes">
                        </dx-text-area>
                    </div>
                </div>
                <div class="dx-field">
                    <form (ngSubmit)="addClientInfo()">
                        <dx-button type="success" icon="arrowdown" text="Add Client" [useSubmitBehavior]="true"></dx-button>
                    </form>
                    <dx-button (onClick)="resetClientInput()" type="danger" icon="close" text="Reset" [useSubmitBehavior]="false"></dx-button>
                </div>
            </div>
        </div>
        <hr>
        <p class="text-center">Clients list</p>
        <dx-data-grid
            height="150px"
            [dataSource]="roomBooking.clients"
            [columns]="['name', 'address', 'email', 'identityOrPassport', 'nationality', 'notes']"
            [showBorders]="true">
            <dxo-scrolling mode="virtual"></dxo-scrolling>
            <dxo-editing
                mode="row"
                [allowUpdating]="true"
                [allowDeleting]="true">
            </dxo-editing>
        </dx-data-grid>
    </div>
    <div class="group-btn">
        <dx-button (onClick)="cancelBooking()" type="danger" icon="close" text="Cancel"></dx-button>
        <dx-button (onClick)="bookPersonalRoom()" type="success" icon="check" text="Ok"></dx-button>
    </div>
</dx-popup>
